# 9장 플래시, 비디오, 오디오 
## 배울 내용
- 웹페이지에서 플래시를 추가하는 방법
- HTML5의 `<video>`와 `<audio>`요소를 사용하는 방법
- 자체적인 비디오와 오디오를 추가할 때와 유튜브 같은 서비스를 사용할 때


## 플래시 동작 방법

    1. 플래시 저작 도구에서 플래시 동영상을 제작한다.
    2. 플래시 동영상을 .swf 포맷으로 저장한다.
    3. .swf 파일을 자바스크립틀르 사용해 웹 페이지에 추가한다.


- 플래시에서 애니메이션이나 미디어 플레이어를 제작할 때 웹사이트에 추가하는 파일을  **플래시 동영상**이라고 한다.
- 플래시 파일은 확장자가 `.fla`인 파일로 저장된다.
- HTML 페이지에 플래시를 추가하기 위해서는 `<object>`와 `<embed>` 태그를 사용한다. 하지만 이제 일반적으로 **자바스크립트를 사용**한다.
- 브라우저에서 플래시 플레이어라는 플러그인을 설치해야 볼 수 있다.
  
## 플래시의 사용
플래시가 인기가 있었지만, 지금은 전체 웹사이트를 플래시로구축하는 방식을 고려하지 않는다. 

- 플래시 사용이 줄어드는 이유
    - 애니메이션을 자바스크립트를 이용해 좀 더 쉽게 만들 수 있다.
    - 시각 장애인이나 신체 장애인도 웹 사이트를 사용할 수 있게 구축해야 하는 법률이 도입됐다.
        - 플래시로 작성되면 스크린 리더와 같은 기기의 접근성을 충족하지 못한다.
    - HTML5의 `<video>`와 `<audio>` 태그를 지원하기 시작했다.
        - 이전에는 비디오나 오디오를 넣는 방법이 한정적이었다.

## 웹 페이지에 플래시 동영상 추가 
* 자바스크립트를 사용하기 : SWFObject(구글 무료 라이브러리)
    - 사용자가 플래시를 표시하지 못하는 브라우저를사용하는 경우 대체 콘텐츠를 보여 줄 수 있다.                
        1. SWObject 스크립트는 사용자의 브라우저가 플래시 동영상을 재생할 수 있는지 확인
        2. 재생할 수 있다면 스크립트는 <div> 요소의 콘텐츠를 .swf 파일로 교체 
* 이점 
    - 대체 텍스트는 플래시 파일을 사용할 수 없는 시각 장애인이나 신체 장애인도 접근할 수 있다.
    - 텍스트는 SWF 파일 색인화에 효과적이지 않은 검색엔진도 색인화 할 수 있으며, 콘텐츠의 노출 빈도를 높일 수 있다.

---

    <!DOCTYPE html>
    <html>
        <head>
            <title>플래시 동영상 추가</title>
            <script type="text/javascript" 
                src="http://ajax.googleapis.com/ajax/libs/swfobject/2.2/swfobject.js">
            </script>
            <script type="text/javascript">
                swfobject.embedSWF("flash/bird.swf",    <!-- .swf 파일 위치 --> 
                                   "bird",              <!-- 플래시 동영상 대체 요소 ID -->
                                   "400",               <!-- 동영상 너비 -->
                                   "300",               <!-- 동영상 높이 -->
                                   "8.0.0";             <!-- 플래시 플레이어 최소 버전 -->
            </script>
        </head>
        <body>
            <div id="bird">
                <p>새가 샤워하는 애니메이션</p>
            </div>
        </body>
    </html>

---

## 비디오 포맷과 플레이어의 이해 
사이트에 비디오를 추가하려면 파일 포맷과 비디오 플레이어/플러그인이라는 두 가지 핵심 사항을 이해해야 한다.

### 포맷
다양한 포맷을 사용할 수 있다.
 
- AVI
- 플래시 비디오
- H264
- MPEG
- Ogg Theora
- 퀵타임
- WebM
- 윈도우 미디어

> 브라우저 별로 지원하는 비디오 포맷이 다르다.

### 플레이어/플러그인
- Before
    - 비디오를 재생하려면 일반적으로 플레이어나 플러그인이라는 별도의 프로그램을 설치해야 했다. 그리고 **특정 비디오 포맷만 지원**한다.
- After
    - HTML5의 `<video>` 태그를 지원하는 브라우저가 생겨나 플러그인과 플레이어가 필요없게 됐다.

> 하지만 모든 사용자가 HTML5를 지원하는 최신 브라우져를 사용하지 않는다.

### 접근방법
- 비디오 추가 방법
    1. 유튜부나 비메오 같은 사이트의 서비스를 이용하기
    2. HTML5의 `<video>` 요소를 사용하거나 플래시 비디오를 사용하는 것 
        - WebM과 MP4의 두 가지 동영상 포맷이 필요하다.

## 비디오 서비스 제공 사이트 이용
- 장점 
    1. 대다수 웹 브라우저에서 동작하는 플레이어를 제공한다.
    2. 비디오 인코딩에 대해 걱정할 필요가 없다.
    3. 대역폭에 대한 비용을 지불할 필요가 없다.
- 단점
    1. 서비스 제공 사이트에 비디오가 위치하기 때문에 독점적으로 사용하기가 어렵다.
    2. 업로드하는 비디오를 서비스 제공 사이트에 따라 제한 되기도 한다.
    3. 비디오 시작 전에 자체 광고를 삽입하거나 비디오 재생 중에 광고가 나타나기도 한다.
    4. 서비스의 비디오 품질에 제약을 두기도 한다.
- 대안
    1. 자체 사이트에서 비디오를 제공하고, 비디오 제공 방식을 두가지 방식(플래시 비디오 또는 HTML5 요소)을 사용한다.


## 사이트에서 직접 플래시 비디오 제공
웹 페이지에 플래시 비디오 추가하는 세 단계

1. 비디오를 flv 포맷으로 변환한다.
2. 비디오를 재생할 수 있는 flv 플레이어를 찾는다.
    - 플래이어의 목적은 flv 동영상을 담고 재생이나 일시 정지 같은 컨트롤을 추가하기 위해서이다.
    - 플래이어 제공 사이트
        - www.osflv.com (사라짐)
        - www.longtailvideo.com
3. 페이지에 플레이어와 비디오를 포함시킨다.
    - SWFObject와 같은 자바스크립트 기술을 사용


## 페이지에 플래시 비디오 추가
비디오 플레이어는 재생할 비디오의 경로를 알아야 하므로 SWFObject는 자바스크립트 변수를 사용해 플래시 동영상에 비디오 경로 정보를 넘겨준다.

---

    <!DOCTYPE html>
    <html>
        <head>
            <title>플래시 동영상 추가</title>
            <script type="text/javascript" 
                src="http://ajax.googleapis.com/ajax/libs/swfobject/2.2/swfobject.js">
            </script>
            <script type="text/javascript">
                var flashvars = {};
                var params = {                           <!-- .flv 파일 위치 -->
                    movie: "../video/puppy.flv"
                };
                swfobject.embedSWF("flash/osplayer.swf", <!-- .swf 파일 위치 --> 
                                   "snow",               <!-- 플래시 동영상 대체 요소 ID -->
                                   "400",                <!-- 동영상 너비 -->
                                   "300",                <!-- 동영상 높이 -->
                                   "8.0.0",              <!-- 플래시 플레이어 최소 버전 -->
                                   flashvars,            <!-- 플래시 추가 정보 --> 
                                   params);              <!-- 플래시 동영상 비디오 정보 경로 -->
            </script>
        </head>
        <body>
            <div id="bird">
                <p>눈에 뛰노는 강아지 비디오</p>
            </div>
        </body>
    </html>

---

## HTML5: 페이지에서 사용할 비디오 준비
HTML5 비디오 요소(`<video>`) 요소는 최근에 추가되어 다음 사항을 알아야 한다.

- 지원
    - 최근 브라우저에서만 지원한다.
    - 모든 사용자가 사용하게 하려면 플래시 비디오를 결합해서 사용해야 한다.
- 디지털 저작권
    - DRM은 지원하지 않는다.
-포맷
    - 모든 브라우저가 상이한 비디오 포맷을 지원하기에 하나 이상의 포맷으로 비디오를 제공해야 한다.
    - 지원 포맷
        - H264: IE, 사파리
        - WebM: 안드로이드, 크롬, 파이어폭스, 오페라 
-컨트롤 
    - 플레이어를 위한 자체적인 컨트롤을 제공하지만 브라우저마다 모양이 다르다.
        - 모양은 자바스크립트를 통해 제어할 수 있다.
- 브라우져
    - HTML5에서 일관성을 높여준다.

## HTML5: 페이지에 비디오 추가
HTML5에서 `<video>`요소를 사용하는 모든 속성에 대해 값을 제공할 필요가 없다. 속성이 있으면 옵션이 적용되고, 속성을 생략하면 옵션이 적용되지 않는다.

### `<video>`
비디오 재생을 제어할 수 있는 많은 속성이 있음

- `src` : 비디오에 대한 경로를 지정
- `poster` : 비디오를 내려 받는 동안에 표시할 이미지를 지정
- `width`, `height` : 플레이어의 크기
- `controls` : 재생을 위해 자체적인 컨트롤 제공 여부
- `autoplay` : 파일이 자동 재생 여부
- `loop` : 비디오 반복 재생
- `preload` : 페이지를 로드할 때 수행할 작업을 다음 세개 값 중 하나를 선택
    - none : 재생 버튼을 누를 때까지 비디오를 로드하지 않는다.
    - auto : 페이지를 로드할 때 비디오를 내려 받는다.
    - metadata : 크기, 첫 번째 프레임, 트랙 목록, 재생시간 등의 정보를 수집한다.

---

    <!DOCTYPE html>
    <html>
        <head>
            <title>HTML5 동영상 추가</title>
        </head>
        <body>
            <video src="video/puppy.mp4"
                   poster="images/puppy.jpg"
                   width="400"
                   height="300"
                   preload
                   controls
                   loop>
                <p>눈에 뛰노는 강아지 비디오</p>
            </video>
        </body>
    </html>

---

## HTML5: 다중 비디오 소스
`<source>` 요소를 이용해 재생할 파일 위치를 다수로 지정할 수 있다. `<video>` 태그의 src 속성을 대체한다.

- `src` : 비디오에 대한 경로
- `type` : 브라우저에게 비디오의 포맷을 알려준다. 
- `codecs` : type 속성 안에 설정한 비디오를 인코딩하는 데 사용

---

    <!DOCTYPE html>
    <html>
        <head>
            <title>HTML5 동영상 추가</title>
        </head>
        <body>
            <video poster="images/puppy.jpg"
                   width="400"
                   height="300"
                   preload
                   controls
                   loop>
                <source src="video/puppy.mp4"       <!-- MP4 포맷 설정 -->
                        type='video/mp4;codecs="avc1.42E01E, mp4a.40.2"' />
                <source src="video/puppy.webm"      <!-- WebM 포맷 설정 -->
                        type='video/webm;codecs="vp8, vorbis"' />
                <p>눈에 뛰노는 강아지 비디오</p>
            </video>
        </body>
    </html>

---

## HTML5: 플래시와 HTML5 비디오 결합
HTML5와 플래시 비디오 포맷을 모두 제공함으로써, 싸이트의 대부분 사용자가 보게 할 수 있다.

- 방안
    - HTML5를 첫 번째 옵션으로 제공하고 HTML5 비디오를 지원하지 않는 브라우저를 사용하는 사람들을 위한 대안으로 플래시 비디오를 제공
    - 플래시에 내장된 일부 비디오 플레이어는 H264 인코딩을 지원하므로 이 포맷을 지원하는 플레이어를 사용한다면 H264와 WebM 포맷의 비디오만 제공하면 된다.
- HTML5 비디오를 사용할 때 장점
    - 자체적인 재생 컨트롤을 만들 수 있다.
    - 화면 크기가 다른 브라우저를 위해 다른 버전의 비디오를 제공할 수 있다.
    - 비디오가 특정 지점에 도달할 때 페이지의 다른 부분을 변경 할 수 있다. 

## 웹 페이지에 오디오 추가
MP3 포맷을 사용해 오디오를 추가한다. 

- 오디오 추가 방법
    1. 서비스 제공 사이트 사용
    2. 플래시 사용
    3. HTML5 사용 : `<audio>` 태그 사용


### 페이지 간에 이동할 때에도 음악을 계속 재생할 수 있는 방법
- 페이지 콘텐츠 로드를 위해 에이잭스(ajax)를 사용
- 전체 사이트를 플래시로 개발
- 오디오 플레이어를 새 창에서 제공


## 플래시 MP4 플레이어 추가
다음 플레시로 작성된 MP3 플레이어를 사용한다.

- http://flash-mp4-player.net (없어짐)
- [http://musicplayer.sourceforge.net](http://musicplayer.sourceforge.net)
- [http://www.wimpyplayer.com](http://www.wimpyplayer.com)

SWFObject 기술을 사용해 페이지에 플레이어를 내장한다. 

## HTML5: 페이지에 HTML5 오디오 추가
HTML5에서 `<audio>`요소를 사용하는 모든 속성에 대해 값을 제공할 필요가 없다. 속성이 있으면 옵션이 적용되고, 속성을 생략하면 옵션이 적용되지 않는다.

### `<audio>`
오디오 재생을 제어할 수 있는 많은 속성이 있음

- `src` : 오디오에 대한 경로를 지정
- `controls` : 재생을 위해 자체적인 컨트롤 제공 여부
- `autoplay` : 파일이 자동 재생 여부
- `loop` : 비디오 반복 재생
- `preload` : 페이지를 로드할 때 수행할 작업을 다음 세개 값 중 하나를 선택
    - none : 재생 버튼을 누를 때까지 오디오를 로드하지 않는다.
    - auto : 페이지를 로드할 때 오디오를 내려 받는다.
    - metadata : 크기, 첫 번째 프레임, 트랙 목록, 재생시간 등의 정보를 수집한다.

## HTML5: 다중 오디오 소스
`<source>` 요소를 이용해 재생할 파일 위치를 다수로 지정할 수 있다. `<audio>` 태그의 src 속성을 대체한다.

- `src` : 오디오에 대한 경로
- `type` : 사용되지 않는다.

- 포맷 별 지원 브라우져
    - MP3 : 사파리 5이상, 크롬 6 이상, IE9
    - Ogg Vorbis : 파이어폭스 3.6 이상, 크롬 6 이상, 오페라 1.5 이상, IE9

---

    <!DOCTYPE html>
    <html>
        <head>
            <title>HTML5 다중 오디오 설정</title>
        </head>
        <body>
            <audio controls autoplay>
                <source src="video/puppy.ogg" />       <!-- OGG 포맷 설정 -->
                <source src="video/puppy.mp3" />       <!-- MP3 포맷 설정 -->
                <p>이 브라우져는 오디오 포맷을 지원하지 않습니다.</p>
            </audio>
        </body>
    </html>

---

